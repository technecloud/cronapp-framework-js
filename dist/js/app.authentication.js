var cronappModules=["ui.router","ui.select","ui-select-infinity","ngResource","ngSanitize","custom.controllers","custom.services","datasourcejs","chart.js","ngJustGage","pascalprecht.translate","tmh.dynamicLocale","ui-notification","ui.bootstrap","ngFileUpload","report.services","upload.services","summernote","ui.tinymce"];window.customModules&&(cronappModules=cronappModules.concat(window.customModules));var app=function(){return angular.module("MyApp",cronappModules).constant("LOCALES",{locales:{pt_br:"Portugues (Brasil)",en_us:"English"},preferredLocale:"pt_br",urlPrefix:""}).config(["$httpProvider",function(e){var t=["$q","$rootScope",function(e,t){return{request:function(e){var t=JSON.parse(sessionStorage.getItem("_u"));return t&&t.token&&(e.headers["X-AUTH-TOKEN"]=t.token,window.uToken=t.token),e}}}];e.interceptors.push(t)}]).config(["$stateProvider","$urlRouterProvider","NotificationProvider",function(e,t,r){r.setOptions({delay:5e3,startTop:20,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"right",positionY:"top"}),window.customStateProvider?window.customStateProvider(e):e.state("login",{url:"",controller:"LoginController",templateUrl:"views/login.view.html"}).state("social",{url:"/connected",controller:"SocialController",templateUrl:"views/login.view.html"}).state("socialError",{url:"/notconnected",controller:"SocialController",templateUrl:"views/login.view.html"}).state("main",{url:"/",controller:"LoginController",templateUrl:"views/login.view.html"}).state("publicRoot",{url:"/public/{name:.*}",controller:"PageController",templateUrl:function(e){return"views/public/"+e.name+".view.html"}}).state("public",{url:"/home/public",controller:"PublicController",templateUrl:function(e){return"views/public/home.view.html"}}).state("public.pages",{url:"/{name:.*}",controller:"PageController",templateUrl:function(e){return"views/public/"+e.name+".view.html"}}).state("home",{url:"/home",controller:"HomeController",templateUrl:"views/logged/home.view.html"}).state("home.pages",{url:"/{name:.*}",controller:"PageController",templateUrl:function(e){return"views/"+e.name+".view.html"}}).state("404",{url:"/error/404",controller:"PageController",templateUrl:function(e){return"views/error/404.view.html"}}).state("403",{url:"/error/403",controller:"PageController",templateUrl:function(e){return"views/error/403.view.html"}}),t.otherwise("/error/404")}]).factory("originPath",["$location",function(e){return{request:function(t){return t.headers["origin-path"]=e.path(),t}}}]).config(["$httpProvider",function(e){e.interceptors.push("originPath")}]).config(["$translateProvider","tmhDynamicLocaleProvider",function(e,t){e.useMissingTranslationHandlerLog(),e.useStaticFilesLoader({files:[{prefix:"i18n/locale_",suffix:".json"},{prefix:"plugins/cronapp-framework-js/i18n/locale_",suffix:".json"}]}),e.registerAvailableLanguageKeys(["pt_br","en_us"],{"en*":"en_us","pt*":"pt_br","*":"pt_br"});var r=(window.navigator.userLanguage||window.navigator.language||"pt_br").replace("-","_");e.use(r.toLowerCase()),e.useSanitizeValueStrategy("escaped"),t.localeLocationPattern("plugins/angular-i18n/angular-locale_{{locale}}.js"),moment&&moment.locale(r)}]).directive("crnValue",["$parse",function(e){return{restrict:"A",require:"^ngModel",link:function(t,r,a,o){var n;n=a.value?a.value:e(a.crnValue)(t),r.attr("data-evaluated",JSON.stringify(n)),r.bind("click",function(e){t.$apply(function(){o.$setViewValue(n)}.bind(r))})}}}]).decorator("$xhrFactory",["$delegate","$injector",function(e,t){return function(r,a){var o=e(r,a),n=t.get("$http"),i=n.pendingRequests[n.pendingRequests.length-1];return angular.isFunction(i.onProgress)&&o.upload.addEventListener("progress",i.onProgress),o}}]).controller("PageController",["$controller","$scope","$stateParams","$location","$http","$rootScope","$translate",function(e,t,r,a,o,n,i){app.registerEventsCronapi(t,i),t.params=r,t.$http=o;var l=a.search();for(var c in l)l.hasOwnProperty(c)&&(t.params[c]=l[c]);t.registerComponentScripts=function(){$(".carousel-indicators li").on("click",function(){var e="#"+$(this).parent().parent().parent().attr("id"),t=$(e+" .carousel-indicators li").index(this);$(e+" #carousel-example-generic").carousel(t)})},t.registerComponentScripts();try{var s=e("AfterPageController",{$scope:t});app.copyContext(s,this,"AfterPageController")}catch(e){}try{t.blockly.events.afterPageRender&&t.blockly.events.afterPageRender()}catch(e){}}]).run(["$rootScope","$state",function(e,t){e.$on("$stateChangeError",function(){if(arguments.length>=6){var e=arguments[5];404!==e.status&&403!==e.status||t.go(e.status.toString())}else t.go("404")})}])}(window);app.userEvents={},app.config={},app.config.datasourceApiVersion=2,app.bindScope=function(e,t){var r={};for(var a in t)"string"==typeof t[a]?r[a]=t[a]:"function"==typeof t[a]?r[a]=t[a].bind(e):r[a]=app.bindScope(e,t[a]);return r},app.registerEventsCronapi=function(e,t){for(var r in app.userEvents)e[r]=app.userEvents[r].bind(e);e.vars={};try{cronapi&&(e.cronapi=app.bindScope(e,cronapi),e.cronapi.$scope=e,e.safeApply=safeApply,t&&(e.cronapi.$translate=t))}catch(e){console.info("Not loaded cronapi functions"),console.info(e)}try{blockly&&(e.blockly=app.bindScope(e,blockly))}catch(e){console.info("Not loaded blockly functions"),console.info(e)}},app.copyContext=function(e,t,r){if(e)for(var a in e)t[a]?t[a+r]=e[a]:t[a]=e[a]},window.safeApply=function(e){var t=this.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():this.$apply(e)},app.kendoHelper={getSchema:function(e){var t=[{kendoType:"string",entityType:["string","character","uuid","guid"]},{kendoType:"number",entityType:["integer","long","double","int","float","bigdecimal","single","int32","int64","decimal"]},{kendoType:"date",entityType:["date","time","datetime"]},{kendoType:"boolean",entityType:["boolean"]}],r=function(e){for(var r=0;r<t.length;r++)if(t[r].entityType.includes(e.toLocaleLowerCase()))return t[r].kendoType;return"string"},a={model:{id:void 0,fields:{}}};return e&&e.schemaFields&&e.schemaFields.forEach(function(e){e.key&&(a.model.id=e.name),a.model.fields[e.name]={type:r(e.type),editable:!0,nullable:e.nullable,validation:{required:!e.nullable}}}),a},getDataSource:function(e,t,r,a){function o(e){if(e.response&&e.response.d){var t=null;t=e.response.d.results?e.response.d.results:[e.response.d],this.group().length?a.forEach(function(e){if("Database"==e.dataType){if("datetime-local"==e.type||"month"==e.type||"time-local"==e.type||"week"==e.type)for(var r=0;r<t.length;r++){var a=t[r];e.field==a.Member&&(a.Key=a.Key.replace(/\d+/,function(e){return parseInt(e)+u})),n.bind(this)(a.Items)}}}):n.bind(this)(t)}}function n(e){for(var t=0;t<e.length;t++)a&&a.forEach(function(r){if("Database"==r.dataType){("datetime-local"==r.type||"month"==r.type||"time-local"==r.type||"week"==r.type)&&e[t][r.field]&&(e[t][r.field]=e[t][r.field].replace(/\d+/,function(e){return parseInt(e)+u}))}})}var i=dataSourceMap[e.id].serviceUrlODATA,l=this.getSchema(e),c=function(e){for(var t in e)if(l.model.fields.hasOwnProperty(t)){var r=l.model.fields[t];"string"==r.type&&void 0!=e[t]?e[t]=e[t]+"":"number"==r.type&&void 0!=e[t]?e[t]=parseFloat(e[t]):"date"==r.type&&void 0!=e[t]&&(e[t]="/Date("+e[t].getTime()+")/"),l.model.id==t&&void 0!=e[t]&&0==e[t].toString().length&&delete e[t]}return e},s=r;t&&(s=r||10);var u=6e4*(new Date).getTimezoneOffset();return{type:"odata",transport:{read:{url:i,dataType:"json"},update:{url:function(e){return e.__metadata.uri}},create:{url:i},destroy:{url:function(e){return e.__metadata.uri}},batch:{url:i},parameterMap:function(e,t){if("read"==t){var r=kendo.data.transports.odata.parameterMap(e,t),a="";return this.options.grid&&this.options.grid.dataSource.group().forEach(function(e){a+=e.field+" "+e.dir+","}),a.length>0&&(a=a.substr(0,a.length-1),r.$orderby?r.$orderby=a+","+r.$orderby:r.$orderby=a),r}return e=c(e),kendo.stringify(e)}},pageSize:s,serverPaging:!0,serverFiltering:!0,serverSorting:!0,batch:!1,schema:l,requestEnd:o}},getConfigCombobox:function(e){var t={},r=!1,t={};!e||e.dynamic&&"false"!=e.dynamic?e.dataSource&&(t=app.kendoHelper.getDataSource(e.dataSource),r=null==e.valuePrimitive?void 0:e.valuePrimitive):(r=!0,e.dataValueField="key",e.dataTextField="value",t.data=null==e.staticDataSource?void 0:e.staticDataSource),e.dataValueField&&""!=e.dataValueField.trim()||(e.dataValueField=null==e.dataTextField?void 0:e.dataTextField);var a={dataTextField:null==e.dataTextField?void 0:e.dataTextField,dataValueField:null==e.dataValueField?void 0:e.dataValueField,dataSource:t,headerTemplate:null==e.headerTemplate?void 0:e.headerTemplate,template:null==e.template?void 0:e.template,placeholder:null==e.placeholder?void 0:e.placeholder,footerTemplate:null==e.footerTemplate?void 0:e.footerTemplate,filter:null==e.filter?void 0:e.filter,valuePrimitive:r,suggest:!0};return e.cascadeFrom&&e.cascadeFromField&&(a.cascadeFrom=e.cascadeFrom,a.cascadeFromField=e.cascadeFromField,a.autoBind=!1),r||(a.optionLabel=null==e.optionLabel?void 0:e.optionLabel),a},getConfigDate:function(e,t){var r={};if(r){var a=function(e){return e=e.replace(/:MM/gm,":mm"),e=e.replace(/:M/gm,":m"),e=e.replace(/S/gm,"s"),e=e.replace(/D/gm,"d"),e=e.replace(/Y/gm,"y")},o={};if(t.animation)try{o=JSON.parse(t.animation)}catch(e){console.log("DateAnimation invalid configuration! "+e)}var n=function(t,r){return r||(r=parseMaskType(t,e)),r}(t.type,t.format);r={value:null,format:a(n),timeFormat:a("time",t.timeFormat),momentFormat:n,culture:function(e){e=e.replace(/_/gm,"-");var t=e.split("-");return t[t.length-1]=t[t.length-1].toUpperCase(),t.join("-")}(e.use()),type:null==t.type?void 0:t.type,weekNumber:null==t.weekNumber?void 0:t.weekNumber,dateInput:null==t.dateInput?void 0:t.dateInput,animation:o,footer:null==t.footer?void 0:t.footer,start:null==t.start?void 0:t.start,depth:null==t.start?void 0:t.start}}return r},buildKendoMomentPicker:function(e,t,r,a){var o="date"==t.type||"datetime"==t.type||"time"==t.type,n=function(){var r=e.val();if(r&&""!=r.trim()){var n=null;n=o?moment.utc(r,t.momentFormat):moment(r,t.momentFormat),a&&n.isValid()&&(a.$setViewValue(n.toDate()),e.data("changed",!0))}else a&&a.$setViewValue("")};return t.change=r?function(){r.$apply(function(){n()})}:n,"date"==t.type?e.kendoDatePicker(t).data("kendoDatePicker"):"datetime"==t.type||"datetime-local"==t.type?e.kendoDateTimePicker(t).data("kendoDateTimePicker"):"time"==t.type||"time-local"==t.type?e.kendoTimePicker(t).data("kendoTimePicker"):void 0},getConfigSlider:function(e){var t={increaseButtonTitle:e.increaseButtonTitle,decreaseButtonTitle:e.decreaseButtonTitle,dragHandleTitle:e.dragHandleTitle};try{t.min=e.min?parseInt(e.min):1,t.max=e.max?parseInt(e.max):1,t.smallStep=e.smallStep?parseInt(e.smallStep):1,t.largeStep=e.largeStep?parseInt(e.largeStep):1}catch(e){console.log("Slider invalid configuration! "+e)}return t},getConfigSwitch:function(e){return{onLabel:e.onLabel,offLabel:e.offLabel}}};